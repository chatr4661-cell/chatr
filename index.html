<!doctype html>
<html lang="en">
  <head>
    <!-- CRITICAL: Preconnect to critical origins FIRST -->
    <link rel="preconnect" href="https://sbayuqgomlflmxgicplz.supabase.co" crossorigin />
    <link rel="dns-prefetch" href="https://sbayuqgomlflmxgicplz.supabase.co" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    
    <!-- CRITICAL: Module preload for instant script execution -->
    <link rel="modulepreload" href="/src/main.tsx" />
    
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5, viewport-fit=cover">
    
    <!-- Reduce layout shift -->
    <meta name="color-scheme" content="light dark">
    <meta name="color-scheme" content="light dark">
    <meta name="format-detection" content="telephone=no">
    
    <!-- Primary Meta Tags -->
    <title>Chatr+ ‚Äî The AI Superapp for India</title>
    <meta name="title" content="Chatr+ ‚Äî The AI Superapp for India">
    <meta name="description" content="Chat, Earn, Create, and Grow ‚Äî All in One App. Chatr+ is a next-gen AI superapp for communication, healthcare, business, and lifestyle across India.">
    <meta name="keywords" content="Chatr+, Chatr App, Super App India, AI Chat App, Health Hub, Doctor Booking, Business CRM, Community App, Local Deals, Food Ordering, TalentXcel, Chat Platform, Social App, AI Assistant, Chatr Chat, Noida Startups, Delhi NCR App">
    <meta name="robots" content="index, follow">
    <meta name="language" content="English">
    <meta name="author" content="TalentXcel Services Pvt. Ltd.">
    
    <!-- Favicon & Icons -->
    <link rel="icon" href="https://chatr.chat/favicon.png" type="image/png">
    <link rel="apple-touch-icon" href="https://chatr.chat/assets/chatrplus-logo512.png">
    <link rel="manifest" href="/manifest.json">
    
    <!-- Theme Colors -->
    <meta name="theme-color" content="#0066FF">
    <meta name="theme-color" media="(prefers-color-scheme: dark)" content="#000000" />
    <meta name="msapplication-TileColor" content="#0066FF">
    
    <!-- iOS PWA Support -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
    <meta name="apple-mobile-web-app-title" content="Chatr+" />
    <link rel="apple-touch-startup-image" href="/chatr-logo.png" />
    
    <!-- Android PWA Support -->
    <meta name="mobile-web-app-capable" content="yes" />
    <meta name="applicable-device" content="pc, mobile, tv">
    
    <!-- Open Graph / Facebook / WhatsApp -->
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://chatr.chat/">
    <meta property="og:title" content="Chatr+ ‚Äî The AI Superapp for India">
    <meta property="og:description" content="Chat, Earn, Create, and Grow ‚Äî All in One App. Your all-in-one ecosystem: chat, call, book doctors, access AI health tools, run your business, and earn ‚Äî with Chatr+.">
    <meta property="og:image" content="https://chatr.chat/assets/chatrplus-og-banner.png">
    <meta property="og:image:alt" content="Chatr+ ‚Äî The AI Superapp for India">
    <meta property="og:site_name" content="Chatr+">
    <meta property="og:locale" content="en_IN">
    <meta property="og:image:width" content="1200">
    <meta property="og:image:height" content="630">
    
    <!-- Twitter / X Meta -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@ChatrAppOfficial">
    <meta name="twitter:creator" content="@TalentXcel">
    <meta name="twitter:url" content="https://chatr.chat/">
    <meta name="twitter:title" content="Chatr+ ‚Äî The AI Superapp for India">
    <meta name="twitter:description" content="Chat, Earn, Create, and Grow ‚Äî All in One App. Chatr+ is the AI superapp redefining communication, business, and community across India.">
    <meta name="twitter:image" content="https://chatr.chat/assets/chatrplus-og-banner.png">
    <meta name="twitter:image:alt" content="Chatr+ Super App Preview">
    <meta name="twitter:label1" content="Users">
    <meta name="twitter:data1" content="325+ and growing">
    <meta name="twitter:label2" content="Earn Rewards">
    <meta name="twitter:data2" content="Join Chatr Champions">
    
    <!-- App Store / Deep Link Integration -->
    <meta name="apple-itunes-app" content="app-id=1234567890">
    <meta name="google-play-app" content="app-id=com.chatrplus.app">
    
    <!-- Deep Links -->
    <meta property="al:android:url" content="chatr://open">
    <meta property="al:android:package" content="com.chatrplus.app">
    <meta property="al:android:app_name" content="Chatr+">
    <meta property="al:ios:url" content="chatr://open">
    <meta property="al:ios:app_store_id" content="1234567890">
    <meta property="al:ios:app_name" content="Chatr+">
    
    <!-- Canonical & Alternate Links -->
    <link rel="canonical" href="https://chatr.chat/">
    <link rel="alternate" href="https://chatr.chat/" hreflang="en-in" />
    
    <!-- Social Share Enhancements -->
    <meta property="article:author" content="https://talentxcel.in">
    <meta property="article:publisher" content="https://chatr.chat">
    <meta property="article:section" content="Technology">
    <meta property="article:tag" content="AI, Chat, Super App, Business Tools, Health Tech, Startup India">
    
    <!-- Structured Data Schema - Organization -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Organization",
      "name": "Chatr+",
      "alternateName": "Chatr Plus",
      "url": "https://chatr.chat",
      "logo": "https://chatr.chat/assets/chatrplus-logo512.png",
      "sameAs": [
        "https://twitter.com/ChatrAppOfficial",
        "https://linkedin.com/company/talentxcel",
        "https://www.instagram.com/chatrplus/",
        "https://www.facebook.com/chatrplus"
      ],
      "founder": {
        "@type": "Person",
        "name": "TalentXcel Team",
        "url": "https://talentxcel.in"
      },
      "description": "Chatr+ is an integrated platform merging chat, health, AI, business, and community tools into one super-app ecosystem.",
      "foundingDate": "2025",
      "location": {
        "@type": "Place",
        "address": {
          "@type": "PostalAddress",
          "addressLocality": "Noida",
          "addressRegion": "Uttar Pradesh",
          "addressCountry": "IN"
        }
      }
    }
    </script>
    
    <!-- Structured Data Schema - Mobile Application -->
    <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "MobileApplication",
      "name": "Chatr+",
      "operatingSystem": "Android, iOS, Web",
      "applicationCategory": "Social Communication, Health, Business, Lifestyle",
      "aggregateRating": {
        "@type": "AggregateRating",
        "ratingValue": "4.9",
        "ratingCount": "325"
      },
      "offers": {
        "@type": "Offer",
        "price": "0",
        "priceCurrency": "INR"
      },
      "featureList": [
        "üí¨ Chat ‚Äî Messages, Calls, & Video",
        "‚ù§Ô∏è Health Hub ‚Äî AI assistant, vitals & reports",
        "‚öïÔ∏è Care Access ‚Äî Book doctors & emergency help",
        "üåç Community ‚Äî Groups, stories & challenges",
        "üì± Mini-Apps ‚Äî Discover & install apps",
        "üè¢ Business ‚Äî CRM, inbox & analytics",
        "‚úÖ Official ‚Äî Verified accounts & services",
        "üí∏ Chatr Champions ‚Äî Earn ‚Çπ through referrals",
        "ü§ù Chatr Partner ‚Äî Join our campus & business partner programs",
        "ü©∫ Doctor Portal ‚Äî Register as a healthcare provider",
        "üç≤ Ecosystem ‚Äî Food ordering, local deals & more",
        "‚ö° Quick Access ‚Äî Chatr Studio, AI Assistant, Emergency tools"
      ],
      "url": "https://chatr.chat"
    }
    </script>
    <!-- CRITICAL CSS: Inlined for instant first paint -->
    <style>
      /* Minimal critical CSS for instant skeleton */
      :root { --background: 0 0% 100%; --foreground: 220 13% 10%; --muted: 220 13% 96%; --primary: 262 100% 46%; }
      @media (prefers-color-scheme: dark) { :root { --background: 220 13% 4%; --foreground: 0 0% 98%; --muted: 220 13% 15%; } }
      body { margin: 0; font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: hsl(var(--background)); color: hsl(var(--foreground)); }
      #root { min-height: 100vh; min-height: 100dvh; }
      
      /* Instant skeleton animation */
      @keyframes shimmer { 0% { background-position: -200% 0; } 100% { background-position: 200% 0; } }
      .skeleton { background: linear-gradient(90deg, hsl(var(--muted)) 25%, hsl(var(--muted) / 0.5) 50%, hsl(var(--muted)) 75%); background-size: 200% 100%; animation: shimmer 1.5s infinite; }
      
      /* Instant app shell */
      .instant-shell { display: flex; flex-direction: column; min-height: 100vh; min-height: 100dvh; }
      .instant-header { height: 56px; background: hsl(var(--background)); border-bottom: 1px solid hsl(var(--muted)); display: flex; align-items: center; padding: 0 16px; }
      .instant-content { flex: 1; padding: 16px; }
      .instant-nav { height: 64px; background: hsl(var(--background)); border-top: 1px solid hsl(var(--muted)); display: flex; justify-content: space-around; align-items: center; position: sticky; bottom: 0; }
      .instant-item { display: flex; align-items: center; gap: 12px; padding: 12px 0; border-bottom: 1px solid hsl(var(--muted) / 0.5); }
      .instant-avatar { width: 48px; height: 48px; border-radius: 50%; }
      .instant-text-lg { height: 14px; border-radius: 7px; width: 60%; }
      .instant-text-sm { height: 10px; border-radius: 5px; width: 40%; margin-top: 6px; }
      .instant-nav-item { width: 24px; height: 24px; border-radius: 8px; }
    </style>
  </head>

  <body>
    <!-- INSTANT APP SHELL: Shows immediately while JS loads -->
    <div id="root">
      <div class="instant-shell">
        <div class="instant-header">
          <div class="skeleton instant-avatar" style="width:32px;height:32px"></div>
          <div style="flex:1;margin-left:12px"><div class="skeleton" style="width:120px;height:14px;border-radius:7px"></div></div>
        </div>
        <div class="instant-content">
          <div class="instant-item"><div class="skeleton instant-avatar"></div><div style="flex:1"><div class="skeleton instant-text-lg"></div><div class="skeleton instant-text-sm"></div></div></div>
          <div class="instant-item"><div class="skeleton instant-avatar"></div><div style="flex:1"><div class="skeleton instant-text-lg"></div><div class="skeleton instant-text-sm"></div></div></div>
          <div class="instant-item"><div class="skeleton instant-avatar"></div><div style="flex:1"><div class="skeleton instant-text-lg"></div><div class="skeleton instant-text-sm"></div></div></div>
          <div class="instant-item"><div class="skeleton instant-avatar"></div><div style="flex:1"><div class="skeleton instant-text-lg"></div><div class="skeleton instant-text-sm"></div></div></div>
          <div class="instant-item"><div class="skeleton instant-avatar"></div><div style="flex:1"><div class="skeleton instant-text-lg"></div><div class="skeleton instant-text-sm"></div></div></div>
        </div>
        <div class="instant-nav">
          <div class="skeleton instant-nav-item"></div>
          <div class="skeleton instant-nav-item"></div>
          <div class="skeleton instant-nav-item"></div>
          <div class="skeleton instant-nav-item"></div>
        </div>
      </div>
    </div>
    
    <!-- CRITICAL: Load main script with high priority -->
    <script type="module" src="/src/main.tsx" fetchpriority="high"></script>
    
    <!-- Service Worker Registration - PWA Compliant with Ultra-Resilient Error Handling -->
    <script>
      (function() {
        // Wrap entire SW logic to prevent ANY errors from causing blank screen
        if (!('serviceWorker' in navigator)) return;
        
        window.addEventListener('load', function() {
          // Use setTimeout to ensure React has fully mounted first
          setTimeout(function() {
            registerSW().catch(function() {});
          }, 1000);
        });
        
        async function registerSW() {
          try {
            // Check existing registration first
            const existing = await navigator.serviceWorker.getRegistration('/').catch(function() { return null; });
            if (existing) {
              console.log('SW already registered');
              // Silently update - never throw
              existing.update().catch(function() {});
              setupSWListeners(existing);
              return;
            }
            
            // Check if sw.js exists - use timeout to prevent hanging
            const controller = new AbortController();
            const timeoutId = setTimeout(function() { controller.abort(); }, 3000);
            
            const swCheck = await fetch('/sw.js', { 
              method: 'HEAD',
              signal: controller.signal 
            }).catch(function() { return null; });
            
            clearTimeout(timeoutId);
            
            if (!swCheck || !swCheck.ok) {
              console.log('SW file not available, skipping');
              return;
            }
            
            // Register with timeout protection
            const registration = await navigator.serviceWorker.register('/sw.js', {
              scope: '/',
              updateViaCache: 'none'
            }).catch(function(err) {
              console.log('SW registration skipped:', err.message);
              return null;
            });
            
            if (!registration) return;
            
            console.log('SW registered');
            setupSWListeners(registration);
            
          } catch (err) {
            // Silently fail - SW is optional, never crash the app
            console.log('SW setup skipped');
          }
        }
        
        function setupSWListeners(registration) {
          try {
            // Silent periodic updates
            setInterval(function() {
              registration.update().catch(function() {});
            }, 60000);
            
            // Request notification permission
            if ('Notification' in window && Notification.permission === 'default') {
              Notification.requestPermission().catch(function() {});
            }
            
            // Register periodic sync (optional)
            if ('periodicSync' in registration) {
              registration.periodicSync.register('sync', {
                minInterval: 24 * 60 * 60 * 1000
              }).catch(function() {});
            }
            
            // Listen for updates
            registration.addEventListener('updatefound', function() {
              var newWorker = registration.installing;
              if (newWorker) {
                newWorker.addEventListener('statechange', function() {
                  if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                    newWorker.postMessage({ type: 'SKIP_WAITING' });
                    window.location.reload();
                  }
                });
              }
            });
            
            // Handle controller change
            var refreshing = false;
            navigator.serviceWorker.addEventListener('controllerchange', function() {
              if (!refreshing) {
                refreshing = true;
                window.location.reload();
              }
            });
          } catch (err) {
            // Silently ignore listener setup errors
          }
        }
      })();
      
      // Handle install prompt
      let deferredPrompt;
      window.addEventListener('beforeinstallprompt', (e) => {
        e.preventDefault();
        deferredPrompt = e;
        console.log('PWA Install prompt ready');
        
        // Optionally show install button
        window.showInstallPrompt = () => {
          if (deferredPrompt) {
            deferredPrompt.prompt();
            deferredPrompt.userChoice.then((choice) => {
              console.log('User choice:', choice.outcome);
              deferredPrompt = null;
            });
          }
        };
      });
      
      // Handle app installed
      window.addEventListener('appinstalled', () => {
        console.log('PWA installed successfully');
        deferredPrompt = null;
      });
    </script>
  </body>
</html>
