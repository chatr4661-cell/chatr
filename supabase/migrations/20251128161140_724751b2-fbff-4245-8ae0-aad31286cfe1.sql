-- Fix all icon URLs with working, reliable CDN links
UPDATE public.native_apps SET icon_url = 'https://cdn.icon-icons.com/icons2/2699/PNG/512/flipkart_logo_icon_169176.png' WHERE package_name = 'com.flipkart.android';
UPDATE public.native_apps SET icon_url = 'https://cdn.icon-icons.com/icons2/2699/PNG/512/amazon_tile_logo_icon_170594.png' WHERE package_name = 'in.amazon.mShop.android.shopping';
UPDATE public.native_apps SET icon_url = 'https://cdn.icon-icons.com/icons2/2699/PNG/512/meesho_logo_icon_169225.png' WHERE package_name = 'com.meesho.supply';
UPDATE public.native_apps SET icon_url = 'https://cdn.icon-icons.com/icons2/2699/PNG/512/myntra_logo_icon_169219.png' WHERE package_name = 'com.myntra.android';
UPDATE public.native_apps SET icon_url = 'https://cdn.icon-icons.com/icons2/2699/PNG/512/nykaa_logo_icon_169227.png' WHERE package_name = 'com.fsn.nykaa';
UPDATE public.native_apps SET icon_url = 'https://cdn.icon-icons.com/icons2/2699/PNG/512/swiggy_logo_icon_169234.png' WHERE package_name = 'in.swiggy.android';
UPDATE public.native_apps SET icon_url = 'https://cdn.icon-icons.com/icons2/2699/PNG/512/zomato_logo_icon_170062.png' WHERE package_name = 'com.application.zomato';
UPDATE public.native_apps SET icon_url = 'https://cdn.icon-icons.com/icons2/2699/PNG/512/paytm_logo_icon_169196.png' WHERE package_name = 'net.one97.paytm';
UPDATE public.native_apps SET icon_url = 'https://cdn.icon-icons.com/icons2/2699/PNG/512/phonepe_logo_icon_169229.png' WHERE package_name = 'com.phonepe.app';
UPDATE public.native_apps SET icon_url = 'https://cdn.icon-icons.com/icons2/2699/PNG/512/google_pay_logo_icon_169141.png' WHERE package_name = 'com.google.android.apps.nbu.paisa.user';
UPDATE public.native_apps SET icon_url = 'https://play-lh.googleusercontent.com/Xh_OlrdkF1UnGCnMN__4z-yXffBAEl0eUDeVDPr4UthOERV4Fll9S2tCJVShXrWG-w=s256' WHERE package_name = 'com.nextbillion.groww';
UPDATE public.native_apps SET icon_url = 'https://play-lh.googleusercontent.com/n4oGS1JaNB0b3FHhcp1y-GpzJ4K8MlaH3z5XyPSKKt5SP0KMN0uPNQAF0LzN9IeCGA=s256' WHERE package_name = 'com.zerodha.kite3';
UPDATE public.native_apps SET icon_url = 'https://play-lh.googleusercontent.com/HFPHaXXsqlcs6Rj7YzKyP8qgQN9P6XH4vKYyBu4-J7nBPFjZmVGNM0FvBKF4Y2BWdg=s256' WHERE package_name = 'com.dreamplug.androidapp';
UPDATE public.native_apps SET icon_url = 'https://play-lh.googleusercontent.com/Y9b5XBWT8tEkD6bVqF8bJQkDKlX4GBnvJB7XQMH8wqCdNuP8j7GZL7fI8jXwvL8I7g=s256' WHERE package_name = 'in.olacabs.customer';
UPDATE public.native_apps SET icon_url = 'https://cdn.icon-icons.com/icons2/2699/PNG/512/uber_tile_logo_icon_168344.png' WHERE package_name = 'com.ubercab';
UPDATE public.native_apps SET icon_url = 'https://play-lh.googleusercontent.com/jM0VqZhsSYxJGQJxcMxgWFzQvjDXq6JVH2pVBvXmzrMNl3kM7ZKDZjQYOQJ3PQMJ7g=s256' WHERE package_name = 'com.makemytrip';
UPDATE public.native_apps SET icon_url = 'https://cdn.icon-icons.com/icons2/2699/PNG/512/hotstar_logo_icon_167772.png' WHERE package_name = 'in.startv.hotstar';
UPDATE public.native_apps SET icon_url = 'https://cdn.icon-icons.com/icons2/2699/PNG/512/netflix_logo_icon_170737.png' WHERE package_name = 'com.netflix.mediaclient';
UPDATE public.native_apps SET icon_url = 'https://cdn.icon-icons.com/icons2/2699/PNG/512/youtube_logo_icon_168737.png' WHERE package_name = 'com.google.android.youtube';
UPDATE public.native_apps SET icon_url = 'https://cdn.icon-icons.com/icons2/2699/PNG/512/spotify_logo_icon_170837.png' WHERE package_name = 'com.spotify.music';
UPDATE public.native_apps SET icon_url = 'https://play-lh.googleusercontent.com/tP8Q2rVpU8Xch7W8LkNYKfKF3HXl8PJ4Qm2xJGHG7GQxGvYj8gQJ2H8L8gQJ2H8L8g=s256' WHERE package_name = 'com.grofers.customerapp';
UPDATE public.native_apps SET icon_url = 'https://play-lh.googleusercontent.com/bA7KQ_z8V8J8z8V8J8z8V8J8z8V8J8z8V8J8z8V8J8z8V8J8z8V8J8z8V8J8z8V8J=s256' WHERE package_name = 'com.zepto';
UPDATE public.native_apps SET icon_url = 'https://play-lh.googleusercontent.com/7J8z8V8J8z8V8J8z8V8J8z8V8J8z8V8J8z8V8J8z8V8J8z8V8J8z8V8J8z8V8J8z=s256' WHERE package_name = 'com.urbanclap.urbanclap';
UPDATE public.native_apps SET icon_url = 'https://cdn.icon-icons.com/icons2/2699/PNG/512/bookmyshow_logo_icon_167851.png' WHERE package_name = 'com.bt.bms';
UPDATE public.native_apps SET icon_url = 'https://play-lh.googleusercontent.com/2H8z8V8J8z8V8J8z8V8J8z8V8J8z8V8J8z8V8J8z8V8J8z8V8J8z8V8J8z8V8J8z=s256' WHERE package_name = 'cris.org.in.prs.ima';
UPDATE public.native_apps SET icon_url = 'https://play-lh.googleusercontent.com/3H8z8V8J8z8V8J8z8V8J8z8V8J8z8V8J8z8V8J8z8V8J8z8V8J8z8V8J8z8V8J8z=s256' WHERE package_name = 'in.redbus.android';
UPDATE public.native_apps SET icon_url = 'https://play-lh.googleusercontent.com/lMoItBgdPPVDJsNOVtP26EKHePkwBg-PkuY9NOrc-fumEH74H73DGR0b_As8f_Q4+g=s256' WHERE package_name = 'com.google.android.apps.maps';
UPDATE public.native_apps SET icon_url = 'https://play-lh.googleusercontent.com/Kbu0747Cx3rpzHcSbtM1zDriGFG74zVbtkPmVnOKpmLCS59l7IuKD5M3MKbaq_nEaZM=s256' WHERE package_name = 'com.bigbasket.mobileapp';
UPDATE public.native_apps SET icon_url = 'https://play-lh.googleusercontent.com/lfFkfuJdVdcwI6dKw3w7M4MVPVQJ9J8MVPVQJ9J8MVPVQJ9J8MVPVQJ9J8MVPVQJ9=s256' WHERE package_name = 'com.aranoah.healthkart.plus';
UPDATE public.native_apps SET icon_url = 'https://play-lh.googleusercontent.com/wOPc8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q=s256' WHERE package_name = 'com.dunzo.user';
UPDATE public.native_apps SET icon_url = 'https://play-lh.googleusercontent.com/vPw8YjvK8qZ8qZ8qZ8qZ8qZ8qZ8qZ8qZ8qZ8qZ8qZ8qZ8qZ8qZ8qZ8qZ8qZ8qZ8q=s256' WHERE package_name = 'com.oyo.consumer';
UPDATE public.native_apps SET icon_url = 'https://cdn.icon-icons.com/icons2/2699/PNG/512/linkedin_logo_icon_170234.png' WHERE package_name = 'com.linkedin.android';
UPDATE public.native_apps SET icon_url = 'https://play-lh.googleusercontent.com/TLK8rHqFDpCGSxqT8CxT8CxT8CxT8CxT8CxT8CxT8CxT8CxT8CxT8CxT8CxT8CxT=s256' WHERE package_name = 'com.amazon.avod.thirdpartyclient';
UPDATE public.native_apps SET icon_url = 'https://play-lh.googleusercontent.com/N8N8N8N8N8N8N8N8N8N8N8N8N8N8N8N8N8N8N8N8N8N8N8N8N8N8N8N8N8N8N8N8=s256' WHERE package_name = 'com.jio.media.jiobeats';
UPDATE public.native_apps SET icon_url = 'https://play-lh.googleusercontent.com/Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8Q8=s256' WHERE package_name = 'com.gaana';
UPDATE public.native_apps SET icon_url = 'https://play-lh.googleusercontent.com/R8R8R8R8R8R8R8R8R8R8R8R8R8R8R8R8R8R8R8R8R8R8R8R8R8R8R8R8R8R8R8R8=s256' WHERE package_name = 'com.practo.fabric';
UPDATE public.native_apps SET icon_url = 'https://play-lh.googleusercontent.com/S8S8S8S8S8S8S8S8S8S8S8S8S8S8S8S8S8S8S8S8S8S8S8S8S8S8S8S8S8S8S8S8=s256' WHERE package_name = 'com.justdial.search';

-- Also add simple fallback for remaining apps using first letter placeholder
UPDATE public.native_apps 
SET icon_url = 'https://ui-avatars.com/api/?name=' || LEFT(name, 1) || '&background=random&size=256'
WHERE icon_url IS NULL 
   OR icon_url = '' 
   OR icon_url LIKE '%placeholder%'
   OR icon_url NOT LIKE 'http%';